<!DOCTYPE html>
<html lang="zh-CN">
1
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>送给刘嘉宜</title>111
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #000;
            font-family: 'Microsoft YaHei', sans-serif;
        }
1
        /* --- Intro / Envelope Layer --- */
        #intro-layer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #ffffff;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            transition: opacity 1.5s ease-out, visibility 1.5s;
        }

        .instruction-text {
            margin-top: 50px;
            font-size: 1.5rem;
            color: #333;
            animation: bounce 2s infinite;
            font-weight: bold;
            letter-spacing: 2px;
        }

        .envelope-wrapper {
            position: relative;
            cursor: pointer;
            width: 300px;
            height: 200px;
            transition: transform 0.3s;
        }

        .envelope-wrapper:hover {
            transform: scale(1.05);
        }

        .envelope {
            position: relative;
            width: 300px;
            height: 200px;
            background: #ff6f61;
            border-radius: 5px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .pocket {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 0;
            border-left: 150px solid transparent;
            border-right: 150px solid transparent;
            border-bottom: 120px solid #ff857a;
            z-index: 3;
            border-bottom-left-radius: 5px;
            border-bottom-right-radius: 5px;
        }

        .pocket-sides {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 3;
            pointer-events: none;
        }

        .pocket-sides::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 0;
            border-left: 150px solid #ff6f61;
            border-bottom: 100px solid transparent;
            border-top: 100px solid transparent;
        }

        .pocket-sides::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 0;
            width: 0;
            height: 0;
            border-right: 150px solid #ff6f61;
            border-bottom: 100px solid transparent;
            border-top: 100px solid transparent;
        }

        .flap {
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 0;
            border-left: 150px solid transparent;
            border-right: 150px solid transparent;
            border-top: 130px solid #ff5a4e;
            transform-origin: top;
            transition: transform 0.6s ease-in-out, z-index 0.6s;
            z-index: 4;
        }

        .envelope.open .flap {
            transform: rotateX(180deg);
            z-index: 1;
        }

        .paper {
            position: absolute;
            bottom: 10px;
            left: 25px;
            width: 250px;
            height: 160px;
            background: #fff;
            padding: 20px;
            box-sizing: border-box;
            transition: transform 0.8s ease-in-out 0.4s;
            z-index: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: 1.1rem;
            color: #d63384;
            box-shadow: 0 -5px 10px rgba(0, 0, 0, 0.1);
        }

        .paper p {
            margin: 5px 0;
        }

        .envelope.open .paper {
            transform: translateY(-120px) scale(1.1);
            z-index: 5;
        }

        .heart-seal {
            position: absolute;
            top: 85px;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 40px;
            color: #900;
            z-index: 5;
            transition: opacity 0.4s;
            pointer-events: none;
        }

        .envelope.open .heart-seal {
            opacity: 0;
        }

        @keyframes bounce {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        /* --- Heart / Canvas Layer --- */
        #heart-layer {
            opacity: 0;
            transition: opacity 2s ease-in;
            position: relative;
            width: 100vw;
            height: 100vh;
        }

        canvas {
            display: block;
        }

        #text-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #ffb7c5;
            text-align: center;
            pointer-events: none;
            z-index: 10;
        }

        h1 {
            font-size: 2.5rem;
            margin: 0;
            text-shadow: 0 0 20px #ff1493, 0 0 40px #ff69b4;
            white-space: nowrap;
            letter-spacing: 5px;
        }
    </style>
</head>

<body>

    <!-- Intro Layer -->
    <div id="intro-layer">
        <div class="envelope-wrapper" onclick="openEnvelope()">
            <div class="envelope">
                <div class="flap"></div>
                <div class="pocket"></div>
                <div class="pocket-sides"></div> <!-- Side covers -->
                <!-- Fixed Text Layout in Paper -->
                <div class="paper">
                    <p>致 刘嘉宜</p>
                    <p style="font-size: 2rem;">❤️</p>
                </div>
                <div class="heart-seal">❤</div>
            </div>
        </div>
        <div class="instruction-text">请打开信封</div>
    </div>

    <!-- Heart Layer -->
    <div id="heart-layer">
        <div id="text-overlay">
            <h1>刘嘉宜我喜欢你</h1>
        </div>
        <canvas id="heartCanvas"></canvas>
    </div>

    <script>
        // --- Envelope Interaction ---
        let isOpened = false;

        function openEnvelope() {
            if (isOpened) return;
            isOpened = true;

            const envelope = document.querySelector('.envelope');
            envelope.classList.add('open');

            setTimeout(() => {
                const intro = document.getElementById('intro-layer');
                const heartLayer = document.getElementById('heart-layer');

                intro.style.opacity = '0';
                intro.style.visibility = 'hidden';

                heartLayer.style.opacity = '1';

                startHeartAnimation();
            }, 1000);
        }

        // --- Particle & Heart Logic ---
        const canvas = document.getElementById('heartCanvas');
        const ctx = canvas.getContext('2d');

        let width, height;
        let particles = [];
        let stars = [];
        let floaters = [];
        const particleCount = 10000; // Keep high density for hollow shell

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            if (particles.length > 0) initParticles();
        }
        window.addEventListener('resize', resize);

        // Helper: Explicit 3D Point on Heart Surface
        function getHeartPosition(t) {
            const x = 16 * Math.pow(Math.sin(t), 3);
            const y = -(13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t));
            return { x, y };
        }

        class Star {
            constructor() {
                this.reset();
            }
            reset() {
                this.x = Math.random() * width;
                this.y = Math.random() * height;
                this.size = Math.random() * 1.5;
                this.baseOpacity = Math.random() * 0.5 + 0.1;
                this.opacity = this.baseOpacity;
                this.fadeSpeed = 0.005 + Math.random() * 0.01;
                this.fadeDir = Math.random() > 0.5 ? 1 : -1;
            }
            update() {
                this.opacity += this.fadeSpeed * this.fadeDir;
                if (this.opacity > 0.8 || this.opacity < 0.1) this.fadeDir *= -1;
                this.y -= 0.1;
                if (this.y < 0) this.reset();
            }
            draw() {
                ctx.fillStyle = `rgba(255, 255, 255, ${this.opacity})`;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        class Particle {
            constructor() {
                this.reset();
                this.x = width / 2;
                this.y = height / 2;
            }

            reset() {
                // THICK SHELL LOGIC
                // We want a "doughnut" or "tube" volume.
                // Not a thin line, but a thick band of particles.

                const t = Math.random() * Math.PI * 2;
                const h = getHeartPosition(t);

                // Scale factor determines thickness of the shell.
                // Using a bell-curve-like distribution around 1.0 would be nice, 
                // but uniform 0.85 to 1.15 works for "thick wall".
                // Let's try to center it around 1.0 with falloff.
                // (Math.random() + Math.random()) / 2 gives triangle dist around 0.5.
                // So (r+r)/2 * 0.4 + 0.8 -> range 0.8 to 1.2

                const r = (Math.random() + Math.random()) * 0.5; // 0..1 peaked at 0.5
                // Map to 0.8 ... 1.2
                // (r - 0.5) * 0.6 + 1.0 -> -0.3..0.3 + 1.0 -> 0.7..1.3. A bit too thick.
                // Let's shorten it.
                // (r - 0.5) * 0.4 + 1.0 -> 0.8 .. 1.2

                const scale = 1.0 + (r - 0.5) * 0.4;

                this.origX = h.x * scale;
                this.origY = h.y * scale;

                // Z-Thickness should also be substantial to match the visual weight
                // Tube radius logic?
                // Visual thickness in 2D is ~0.4 scale units.
                // In Z, let's match that.

                this.origZ = (Math.random() - 0.5) * 60;

                // Add noise for "sand" texture
                this.origX += (Math.random() - 0.5) * 1.5;
                this.origY += (Math.random() - 0.5) * 1.5;
                this.origZ += (Math.random() - 0.5) * 1.5;

                // Color: Pink/Red/Purple mix
                // More variation in hue for richness
                const hue = 320 + Math.random() * 40;
                // Variation in lightness for depth
                const light = 40 + Math.random() * 40;
                this.color = `hsl(${hue}, 85%, ${light}%)`;

                // Size: Varied for texture
                this.baseSize = 0.8 + Math.random() * 1.2;

                this.vx = 0;
                this.vy = 0;
            }

            update(time, pulseScale) {
                // Projection Logic
                const fov = 350;
                const distance = 500;

                // HEART SIZE LOGIC
                // Reduced from 22 (giant) to 35 (medium/standard) scaling divider
                const baseScale = Math.min(width, height) / 35;
                const scale = baseScale * pulseScale;

                let mx = this.origX * scale;
                let my = this.origY * scale;
                let mz = this.origZ * (pulseScale);

                // Rotation
                const angle = Math.sin(time * 0.8) * 0.05;
                const rx = mx * Math.cos(angle) - mz * Math.sin(angle);
                const rz = mx * Math.sin(angle) + mz * Math.cos(angle);

                const factor = fov / Math.max(10, (distance - rz));

                const tx = width / 2 + rx * factor;
                const ty = height / 2 + my * factor;

                // Lerp movement
                this.x += (tx - this.x) * 0.8;
                this.y += (ty - this.y) * 0.8;

                if (mouse.x != null) {
                    const mdx = mouse.x - this.x;
                    const mdy = mouse.y - this.y;
                    const d = Math.sqrt(mdx * mdx + mdy * mdy);
                    if (d < 100) {
                        const force = (100 - d) / 100;
                        const angle = Math.atan2(mdy, mdx);
                        const push = -20 * force;
                        this.x += Math.cos(angle) * push;
                        this.y += Math.sin(angle) * push;
                    }
                }

                this.scaleFactor = factor;
                this.drawOrder = rz;
            }

            draw() {
                const s = this.baseSize * this.scaleFactor;
                if (s < 0.1) return;

                const light = 50 + (this.drawOrder / 200) * 40;

                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, s, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        class Floater {
            constructor() {
                this.reset();
                this.y = Math.random() * height;
            }
            reset() {
                this.x = Math.random() * width;
                this.y = height + 10;
                this.speed = 0.8 + Math.random() * 1.5;
                const texts = ["爱你每一天", "天天开心", "Love You", "永远在一起", "❤️", "✨"];
                this.text = texts[Math.floor(Math.random() * texts.length)];
                this.opacity = 0;
                this.size = 14 + Math.random() * 16;
            }
            update() {
                this.y -= this.speed;
                if (this.y > height * 0.8) this.opacity += 0.02;
                if (this.opacity > 1) this.opacity = 1;
                if (this.y < height * 0.2) this.opacity -= 0.02;
                if (this.y < -50 || this.opacity < 0) this.reset();
            }
            draw() {
                ctx.font = `bold ${this.size}px "Microsoft YaHei"`;
                ctx.fillStyle = `rgba(255, 105, 180, ${this.opacity})`;
                ctx.shadowBlur = 5;
                ctx.shadowColor = "#ff1493";
                ctx.fillText(this.text, this.x, this.y);
                ctx.shadowBlur = 0;
            }
        }

        function initParticles() {
            particles = [];
            for (let i = 0; i < particleCount; i++) {
                particles.push(new Particle());
            }
            floaters = [];
            for (let i = 0; i < 30; i++) floaters.push(new Floater());
            stars = [];
            for (let i = 0; i < 100; i++) stars.push(new Star());
        }

        let mouse = { x: null, y: null };
        window.addEventListener('mousemove', e => { mouse.x = e.clientX; mouse.y = e.clientY; });
        window.addEventListener('touchmove', e => {
            if (e.touches.length > 0) {
                mouse.x = e.touches[0].clientX;
                mouse.y = e.touches[0].clientY;
            }
        }, { passive: false });
        window.addEventListener('touchend', () => { mouse.x = null; mouse.y = null; });

        function animate() {
            requestAnimationFrame(animate);

            ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';
            ctx.fillRect(0, 0, width, height);

            const time = Date.now() / 1000;

            const beatFrequency = 1.2;
            let beat = Math.abs(Math.sin(time * Math.PI * beatFrequency));
            beat = Math.pow(beat, 10);
            const pulse = 1 + 0.18 * beat;

            stars.forEach(s => { s.update(); s.draw(); });

            particles.forEach(p => {
                p.update(time, pulse);
                p.draw();
            });

            floaters.forEach(f => { f.update(); f.draw(); });
        }

        function startHeartAnimation() {
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;

            initParticles();
            animate();
        }

    </script>
</body>

</html>
